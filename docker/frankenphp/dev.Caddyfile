{
    {$CADDY_GLOBAL_OPTIONS}

    auto_https disable_redirects

    frankenphp {
        {$FRANKENPHP_CONFIG}
    }

    order php_server before file_server
}

{$CADDY_EXTRA_CONFIG}

http://{$SERVER_NAME:localhost} {
    log

    root * /app/public
    encode zstd gzip

    {$CADDY_SERVER_EXTRA_DIRECTIVES}

    # Disable Topics tracking if not enabled explicitly: https://github.com/jkarlin/topics
    header ?Permissions-Policy "browsing-topics=()"

    php_server
}

https://{$SERVER_NAME:localhost} {
    log

    root * /app/public
    encode zstd gzip

    {$CADDY_SERVER_EXTRA_DIRECTIVES}

    # Disable Topics tracking if not enabled explicitly: https://github.com/jkarlin/topics
    header ?Permissions-Policy "browsing-topics=()"

    php_server
}
